import{P as U,_ as ae,B as oe,a as re,d as ue,r as d,C as de,I as se,e as r,J as z,c as ie,o as b,f as e,h as t,K as y,i as x,n as V,k as n,m as C,A as P,N as ce,D as pe}from"./index-BXRoTRPN.js";import{u as me}from"./useTableColumnWidth-CTSg-whZ.js";function fe(i){return U({url:"/system/announcement/list",method:"post",data:i})}function _e(i){return U({url:"/system/announcement/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"post",data:i})}function j(i){return U({url:"/system/announcement/edit",method:"post",data:i})}function ge(i){return U({url:"/system/announcement/add",method:"post",data:i})}const he={class:"app-container"},ve={class:"dialog-footer"},we=oe({name:"User"}),be=Object.assign(we,{setup(i){const{tableRef:A,handleHeaderDragend:H,applyStoredColumnWidths:O}=me("notice-table");re();const{proxy:c}=ue(),$=d([]),s=d(!1);d(!1);const D=d(!0);d(!0);const q=d([]);d(!0),d(!0);const R=d(0),I=d(""),E=d([]),F=de({form:{},queryParams:{pageNo:1,pageSize:10,agentId:void 0,agentName:void 0,generalParentId:void 0,parentId:void 0},rules:{isShow:[{required:!0,message:"请选择是否显示",trigger:"change"}],title:[{required:!0,message:"公告标题不能为空",trigger:"blur"},{min:2,max:50,message:"公告标题长度必须介于 2 和 50 之间",trigger:"blur"}],content:[{required:!0,message:"公共内容不能为空",trigger:"blur"}],sort:[{required:!0,message:"排序不能为空",trigger:"blur"}],source:[{required:!0,message:"来源不能为空",trigger:"blur"}]}}),{queryParams:g,form:o,rules:L}=se(F);function m(){D.value=!0,fe(c.addDateRange(g.value,E.value)).then(u=>{D.value=!1,$.value=u.data.records,R.value=u.data.total,O()})}function W(u){const a=u.id;c.$modal.confirm("是否确定删除该条公告？该操作不可撤回").then(function(){return _e({id:a})}).then(()=>{m(),c.$modal.msgSuccess("删除成功")}).catch(()=>{})}function k(){o.value={id:void 0,agentName:void 0,parentId:void 0,serviceUrl:void 0},c.resetForm("userRef")}function J(){s.value=!1,k()}function K(){k(),s.value=!0,I.value="添加公告"}function G(u){k(),u.id||q.value,o.value=Object.assign({},u),s.value=!0,I.value="修改公告"}function M(u){k(),u.id||q.value,o.value=Object.assign({},u),j(o.value).then(a=>{c.$modal.msgSuccess("修改成功"),s.value=!1,m()}).catch(a=>{m()})}function Q(){c.$refs.userRef.validate(u=>{u&&(o.value.id!=null?j(o.value).then(a=>{c.$modal.msgSuccess("修改成功"),s.value=!1,m()}):ge(o.value).then(a=>{c.$modal.msgSuccess("新增成功"),s.value=!1,m()}))})}return m(),(u,a)=>{const h=r("el-button"),f=r("el-col"),_=r("el-row"),p=r("el-table-column"),X=r("el-switch"),B=r("el-tooltip"),Y=r("el-table"),Z=r("pagination"),S=r("el-input"),v=r("el-form-item"),T=r("el-option"),ee=r("el-select"),te=r("el-form"),le=r("el-dialog"),N=z("hasPermi"),ne=z("loading");return b(),ie("div",he,[e(_,{gutter:20},{default:t(()=>[e(f,{xs:24},{default:t(()=>[y((b(),x(_,{gutter:10,class:"mb8"},{default:t(()=>[e(f,{span:1.5},{default:t(()=>[e(h,{type:"primary",plain:"",icon:"Plus",onClick:K},{default:t(()=>[V("添加公告")]),_:1})]),_:1})]),_:1})),[[N,["announcementAdd"]]]),y((b(),x(Y,{border:"",data:n($),onHeaderDragend:n(H),ref_key:"tableRef",ref:A},{default:t(()=>[e(p,{label:"公告ID",align:"center",width:"90",key:"id",prop:"id","show-overflow-tooltip":!0},{default:t(l=>[C("span",null,P(l.row.id),1)]),_:1}),e(p,{label:"排序",align:"center",key:"sort",width:"60",prop:"sort","show-overflow-tooltip":!0},{default:t(l=>[C("span",null,P(l.row.sort),1)]),_:1}),e(p,{label:"公告标题",align:"center",key:"title",prop:"title","show-overflow-tooltip":!0},{default:t(l=>[C("span",null,P(l.row.title),1)]),_:1}),e(p,{label:"来源",align:"center",key:"source",width:"200",prop:"source","show-overflow-tooltip":!0}),e(p,{label:"是否显示",width:"80",align:"center",key:"isShow",prop:"isShow"},{default:t(l=>[e(X,{size:"large",onChange:w=>M(l.row,w),modelValue:l.row.isShow,"onUpdate:modelValue":w=>l.row.isShow=w},null,8,["onChange","modelValue","onUpdate:modelValue"])]),_:1}),e(p,{label:"添加时间",width:"160",align:"center",key:"addTime",prop:"addTime"}),e(p,{label:"创建人",width:"150",align:"center",key:"creator",prop:"creator"}),e(p,{label:"操作",align:"center",width:"200","class-name":"small-padding fixed-width"},{default:t(l=>[e(B,{disabled:"true",content:"编辑",placement:"top"},{default:t(()=>[y((b(),x(h,{type:"primary",onClick:w=>G(l.row)},{default:t(()=>[V("编辑")]),_:2},1032,["onClick"])),[[N,["announcementEdit"]]])]),_:2},1024),e(B,{disabled:"true",content:"删除",placement:"top"},{default:t(()=>[y((b(),x(h,{type:"danger",onClick:w=>W(l.row)},{default:t(()=>[V("删除")]),_:2},1032,["onClick"])),[[N,["announcementDelete"]]])]),_:2},1024)]),_:1})]),_:1},8,["data","onHeaderDragend"])),[[ne,n(D)]]),y(e(Z,{total:n(R),page:n(g).pageNo,"onUpdate:page":a[0]||(a[0]=l=>n(g).pageNo=l),onPagination:m,limit:n(g).pageSize,"onUpdate:limit":a[1]||(a[1]=l=>n(g).pageSize=l)},null,8,["total","page","limit"]),[[ce,n(R)>0]])]),_:1})]),_:1}),e(le,{title:n(I),modelValue:n(s),"onUpdate:modelValue":a[7]||(a[7]=l=>pe(s)?s.value=l:null),width:"600px","append-to-body":""},{footer:t(()=>[C("div",ve,[e(h,{type:"primary",onClick:Q},{default:t(()=>[V("确 定")]),_:1}),e(h,{onClick:J},{default:t(()=>[V("取 消")]),_:1})])]),default:t(()=>[e(te,{model:n(o),rules:n(L),ref:"userRef","label-width":"80px"},{default:t(()=>[e(_,null,{default:t(()=>[e(f,{span:24},{default:t(()=>[e(v,{label:"公告标题",prop:"title"},{default:t(()=>[e(S,{modelValue:n(o).title,"onUpdate:modelValue":a[2]||(a[2]=l=>n(o).title=l),placeholder:"请输入公告标题",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(f,{span:24},{default:t(()=>[e(v,{label:"来源",prop:"source"},{default:t(()=>[e(S,{modelValue:n(o).source,"onUpdate:modelValue":a[3]||(a[3]=l=>n(o).source=l),placeholder:"请输入来源",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(f,{span:24},{default:t(()=>[e(v,{label:"排序",prop:"sort"},{default:t(()=>[e(S,{modelValue:n(o).sort,"onUpdate:modelValue":a[4]||(a[4]=l=>n(o).sort=l),placeholder:"请输入排序",type:"number",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(f,{span:24},{default:t(()=>[e(v,{label:"是否显示",prop:"isShow"},{default:t(()=>[e(ee,{modelValue:n(o).isShow,"onUpdate:modelValue":a[5]||(a[5]=l=>n(o).isShow=l),placeholder:"全部"},{default:t(()=>[e(T,{key:"1",label:"显示",value:!0}),e(T,{key:"2",label:"隐藏",value:!1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(f,{span:24},{default:t(()=>[e(v,{label:"公告内容",prop:"content"},{default:t(()=>[e(S,{modelValue:n(o).content,"onUpdate:modelValue":a[6]||(a[6]=l=>n(o).content=l),rows:5,type:"textarea",placeholder:"请输入公告内容",maxlength:"250","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}}),ke=ae(be,[["__scopeId","data-v-0e2ac240"]]);export{ke as default};
