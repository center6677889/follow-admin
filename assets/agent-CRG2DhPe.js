import{_ as se,B as pe,a as me,d as fe,r as p,C as B,I as ve,e as s,J as E,c as U,o as m,f as e,h as l,K as w,k as a,l as M,D as K,n as v,N as O,i as h,A as C,m as F,j as ge}from"./index-BXRoTRPN.js";import{_ as L}from"./index-pTY-mJ8b.js";import{m as _e,n as ce,o as be}from"./user-Dhl3jA1d.js";import{a as Ie}from"./invite-Csu05Vq-.js";const ye={class:"app-container"},we={key:0},ke={key:1},Ve={key:0},he={key:1},Ce={class:"dialog-footer"},Ne={class:"dialog-footer"},xe=pe({name:"User"}),Ue=Object.assign(xe,{setup(Pe){const Q=me(),{proxy:g}=fe(),T=p([]),_=p(!1),k=p(!1),$=p(!0),J=p(!0),Y=p([]);p(!0),p(!0);const S=p(0),V=p(""),N=p([]);B([{label:"实盘",value:0},{label:"模拟",value:1}]),B([{label:"顶级代理",value:0}]);const G=B({form:{},formIv:{},queryParams:{pageNo:1,pageSize:10,agentId:void 0,agentName:void 0,generalParentId:void 0,parentId:void 0},rules:{agentName:[{required:!0,message:"代理名称不能为空",trigger:"blur"},{min:2,max:20,message:"代理名称长度必须介于 2 和 20 之间",trigger:"blur"}],serviceUrl:[{required:!0,message:"客服链接不能为空",trigger:"blur"}]},rulesIv:{invitationCode:[{required:!0,message:"邀请码不能为空",trigger:"blur"}],remark:[{required:!0,message:"备注不能为空",trigger:"blur"}]}}),{queryParams:o,form:d,rules:H,rulesIv:W,formIv:u}=ve(G);function x(){$.value=!0,_e(g.addDateRange(o.value,N.value)).then(r=>{$.value=!1,T.value=r.data.records,S.value=r.data.total})}function X(r){Q.push({path:"/system/invite",query:{id:r.id}})}function P(){o.value.pageNo=1,x()}function Z(){N.value=[],g.resetForm("queryRef"),o.value.agentId=void 0,o.value.agentName=void 0,o.value.generalParentId=void 0,o.value.parentId=void 0,g.$refs.deptTreeRef.setCurrentKey(null),P()}function R(){d.value={id:void 0,agentName:void 0,parentId:void 0,serviceUrl:void 0},g.resetForm("userRef")}function ee(){_.value=!1,R()}function le(){R(),_.value=!0,V.value="添加代理"}function ae(r){R(),r.id||Y.value,d.value=Object.assign({},r),_.value=!0,V.value="修改代理"}function te(r){R(),r.id||Y.value,u.value=r,u.value.agentId=r.id,k.value=!0,V.value="新增邀请码"}function ne(){g.$refs.userRef.validate(r=>{r&&(d.value.id!=null?(d.value.agentId=d.value.parentId,ce(d.value).then(n=>{g.$modal.msgSuccess("修改成功"),_.value=!1,x()})):(d.value.parentId||(d.value.parentId=0),be(d.value).then(n=>{g.$modal.msgSuccess("新增成功"),_.value=!1,x()})))})}function oe(){g.$refs.userRefIv.validate(r=>{r&&Ie({agentId:u.value.agentId,invitationCode:u.value.invitationCode,remark:u.value.remark}).then(n=>{g.$modal.msgSuccess("邀请码新增成功"),k.value=!1})})}return x(),(r,n)=>{const i=s("el-form-item"),y=s("el-input"),de=s("el-date-picker"),f=s("el-button"),q=s("el-form"),c=s("el-col"),b=s("el-row"),I=s("el-table-column"),A=s("el-tooltip"),re=s("el-table"),ue=s("pagination"),j=s("el-dialog"),D=E("hasPermi"),ie=E("loading");return m(),U("div",ye,[e(b,{gutter:20},{default:l(()=>[e(c,{xs:24},{default:l(()=>[w(e(q,{model:a(o),ref:"queryRef",inline:!0,"label-width":"68px"},{default:l(()=>[e(i,{label:"总代",prop:"generalParentId"},{default:l(()=>[e(a(L),{style:{width:"240px"},value:a(o).generalParentId,"onUpdate:value":n[0]||(n[0]=t=>a(o).generalParentId=t),values:a(o).generalParentId||0,placeholder:"全部"},null,8,["value","values"])]),_:1}),e(i,{label:"上级代理",prop:"parentId"},{default:l(()=>[e(a(L),{style:{width:"240px"},value:a(o).parentId,"onUpdate:value":n[1]||(n[1]=t=>a(o).parentId=t),placeholder:"全部"},null,8,["value"])]),_:1}),e(i,{label:"代理查询",prop:"agentId"},{default:l(()=>[e(y,{oninput:"if(value.length>6)value=value.slice(0,6)",modelValue:a(o).agentId,"onUpdate:modelValue":n[2]||(n[2]=t=>a(o).agentId=t),type:"number",placeholder:"请输入代理id",clearable:"",style:{width:"240px"},onKeyup:M(P,["enter"])},null,8,["modelValue"])]),_:1}),e(i,{label:"代理名称",prop:"agentName"},{default:l(()=>[e(y,{modelValue:a(o).agentName,"onUpdate:modelValue":n[3]||(n[3]=t=>a(o).agentName=t),placeholder:"请输入会员真实姓名",clearable:"",style:{width:"240px"},onKeyup:M(P,["enter"])},null,8,["modelValue"])]),_:1}),e(i,{label:"创建时间",style:{width:"308px"}},{default:l(()=>[e(de,{modelValue:a(N),"onUpdate:modelValue":n[4]||(n[4]=t=>K(N)?N.value=t:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),e(i,null,{default:l(()=>[e(f,{type:"primary",icon:"Search",onClick:P},{default:l(()=>[v("搜索")]),_:1}),e(f,{icon:"Refresh",onClick:Z},{default:l(()=>[v("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[O,a(J)]]),w((m(),h(b,{gutter:10,class:"mb8"},{default:l(()=>[e(c,{span:1.5},{default:l(()=>[e(f,{type:"primary",plain:"",icon:"Plus",onClick:le},{default:l(()=>[v("添加代理")]),_:1})]),_:1})]),_:1})),[[D,["addAgent"]]]),w((m(),h(re,{border:"",data:a(T)},{default:l(()=>[e(I,{label:"总代（ID）",align:"center",key:"",prop:"","show-overflow-tooltip":!0},{default:l(t=>[t.row.generalParentId>0?(m(),U("span",we,C(t.row.generalParentName)+"("+C(t.row.generalParentId)+")",1)):(m(),U("span",ke,"-"))]),_:1}),e(I,{label:"上级代理（ID）",align:"center",key:"",prop:"","show-overflow-tooltip":!0},{default:l(t=>[t.row.parentId>0?(m(),U("span",Ve,C(t.row.parentName)+"("+C(t.row.parentId)+")",1)):(m(),U("span",he,"-"))]),_:1}),e(I,{label:"名称（ID）",align:"center",key:"",prop:"","show-overflow-tooltip":!0},{default:l(t=>[F("span",null,C(t.row.agentName)+"("+C(t.row.id)+")",1)]),_:1}),e(I,{label:"下级代理总数",align:"center",key:"childAgentCount",prop:"childAgentCount",width:"120","show-overflow-tooltip":!0}),e(I,{label:"下级会员总数",width:"120",align:"center",key:"memberCount",prop:"memberCount","show-overflow-tooltip":!0}),e(I,{label:"客服链接",width:"120",align:"center",key:"serviceUrl",prop:"serviceUrl","show-overflow-tooltip":!0}),e(I,{label:"创建时间",align:"center",key:"createTime",prop:"createTime"}),e(I,{label:"创建人",align:"center",key:"creator",prop:"creator"}),e(I,{label:"操作",align:"center",width:"350","class-name":"small-padding fixed-width"},{default:l(t=>[e(A,{disabled:"true",content:"编辑",placement:"none"},{default:l(()=>[w((m(),h(f,{type:"primary",onClick:z=>ae(t.row)},{default:l(()=>[v("编辑")]),_:2},1032,["onClick"])),[[D,["editAgent"]]])]),_:2},1024),e(A,{disabled:"true",content:"查看邀请码",placement:"none"},{default:l(()=>[w((m(),h(f,{type:"primary",onClick:z=>X(t.row)},{default:l(()=>[v("查看邀请码")]),_:2},1032,["onClick"])),[[D,["seeInvitationCode"]]])]),_:2},1024),e(A,{disabled:"true",content:"新增邀请码",placement:"none"},{default:l(()=>[w((m(),h(f,{type:"primary",onClick:z=>te(t.row)},{default:l(()=>[v("新增邀请码")]),_:2},1032,["onClick"])),[[D,["addInvitationCode"]]])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[ie,a($)]]),w(e(ue,{total:a(S),page:a(o).pageNo,"onUpdate:page":n[5]||(n[5]=t=>a(o).pageNo=t),onPagination:x,limit:a(o).pageSize,"onUpdate:limit":n[6]||(n[6]=t=>a(o).pageSize=t)},null,8,["total","page","limit"]),[[O,a(S)>0]])]),_:1})]),_:1}),e(j,{title:a(V),modelValue:a(_),"onUpdate:modelValue":n[10]||(n[10]=t=>K(_)?_.value=t:null),width:"600px","append-to-body":""},{footer:l(()=>[F("div",Ce,[e(f,{type:"primary",onClick:ne},{default:l(()=>[v("确 定")]),_:1}),e(f,{onClick:ee},{default:l(()=>[v("取 消")]),_:1})])]),default:l(()=>[e(q,{model:a(d),rules:a(H),ref:"userRef","label-width":"80px"},{default:l(()=>[e(b,null,{default:l(()=>[e(c,{span:24},{default:l(()=>[e(i,{label:"上级代理",prop:"parentId"},{default:l(()=>[a(_)?(m(),h(a(L),{key:0,disabled:a(V)=="修改代理",noName:"无",value:a(d).parentId,"onUpdate:value":n[7]||(n[7]=t=>a(d).parentId=t),values:a(d).parentId,placeholder:"无"},null,8,["disabled","value","values"])):ge("",!0)]),_:1})]),_:1})]),_:1}),e(b,null,{default:l(()=>[e(c,{span:24},{default:l(()=>[e(i,{label:"代理名称",prop:"agentName"},{default:l(()=>[e(y,{modelValue:a(d).agentName,"onUpdate:modelValue":n[8]||(n[8]=t=>a(d).agentName=t),placeholder:"请输入代理名称",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(b,null,{default:l(()=>[e(c,{span:24},{default:l(()=>[e(i,{label:"客服链接",prop:"serviceUrl"},{default:l(()=>[e(y,{modelValue:a(d).serviceUrl,"onUpdate:modelValue":n[9]||(n[9]=t=>a(d).serviceUrl=t),placeholder:"请输入客服链接",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),e(j,{title:a(V),modelValue:a(k),"onUpdate:modelValue":n[16]||(n[16]=t=>K(k)?k.value=t:null),width:"600px","append-to-body":""},{footer:l(()=>[F("div",Ne,[e(f,{type:"primary",onClick:oe},{default:l(()=>[v("确 定")]),_:1}),e(f,{onClick:n[15]||(n[15]=t=>k.value=!1)},{default:l(()=>[v("取 消")]),_:1})])]),default:l(()=>[e(q,{model:a(u),rules:a(W),ref:"userRefIv","label-width":"80px"},{default:l(()=>[e(b,null,{default:l(()=>[e(c,{span:24},{default:l(()=>[e(i,{label:"ID",prop:"id"},{default:l(()=>[e(y,{modelValue:a(u).id,"onUpdate:modelValue":n[11]||(n[11]=t=>a(u).id=t),disabled:"",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(b,null,{default:l(()=>[e(c,{span:24},{default:l(()=>[e(i,{label:"代理名称",prop:"agentName"},{default:l(()=>[e(y,{modelValue:a(u).agentName,"onUpdate:modelValue":n[12]||(n[12]=t=>a(u).agentName=t),disabled:"",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(b,null,{default:l(()=>[e(c,{span:24},{default:l(()=>[e(i,{label:"邀请码",prop:"invitationCode"},{default:l(()=>[e(y,{modelValue:a(u).invitationCode,"onUpdate:modelValue":n[13]||(n[13]=t=>a(u).invitationCode=t),placeholder:"请输入邀请码",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(b,null,{default:l(()=>[e(c,{span:24},{default:l(()=>[e(i,{label:"备注",prop:"remark"},{default:l(()=>[e(y,{modelValue:a(u).remark,"onUpdate:modelValue":n[14]||(n[14]=t=>a(u).remark=t),placeholder:"请输入备注",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}}),qe=se(Ue,[["__scopeId","data-v-247b31a7"]]);export{qe as default};
