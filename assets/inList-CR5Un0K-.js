import{_ as Ie,B as Se,a as xe,d as Ve,r as c,C as ae,H as Ce,I as Ae,O as De,e as p,J as oe,c as f,o as d,f as t,h as a,K as U,m as v,k as o,l as F,L as Te,M as $e,i as A,D as K,n as y,j as D,A as _,N as ne,c1 as Ne,s as Ue,t as qe}from"./index-BXRoTRPN.js";import{u as Fe}from"./useCopy-CSzW9GjL.js";import{u as Ye}from"./useTableColumnWidth-CTSg-whZ.js";import{c as Me,a as je,b as Be}from"./money-B5PkZZtV.js";import{u as P,w as Ee}from"./xlsx-Btx5Z9-G.js";const Y=q=>(Ue("data-v-94a74bda"),q=q(),qe(),q),Le={class:"app-container"},Ke={key:0,style:{"margin-left":"8px",color:"#409EFF"}},Pe={class:"ub ub-h ub-ac",style:{"margin-bottom":"10px"}},ze={style:{"font-size":"15px",color:"red","margin-right":"100px"}},He={style:{"font-size":"15px",color:"red"}},Oe={key:0},Re=Y(()=>v("br",null,null,-1)),Qe=Y(()=>v("br",null,null,-1)),We={key:1},Je={key:0},Ze=Y(()=>v("br",null,null,-1)),Ge={key:1},Xe={key:0},et=Y(()=>v("br",null,null,-1)),tt={key:1},lt={class:"red"},at={key:0},ot={key:1,style:{color:"#63a103"}},nt={key:2,style:{color:"#da0114"}},rt=Se({name:"User"}),ut=Object.assign(rt,{setup(q){var R,Q,W,J,Z,G;const{copyText:z}=Fe(),{tableRef:re,handleHeaderDragend:ue,applyStoredColumnWidths:se}=Ye("inList-table"),M=xe(),{proxy:T}=Ve(),j=c([]);c(!1),c(!1);const B=c(!0),de=c(!0);c([]),c(!0),c(!0);const E=c(0);c("");const S=c([]),$=c([]),ie=ae(Ce().listcashinType),pe=ae({form:{},formIv:{},queryParams:{pageNo:1,pageSize:10,agentId:(Q=(R=M.currentRoute.value)==null?void 0:R.query)!=null&&Q.id?(J=(W=M.currentRoute.value)==null?void 0:W.query)==null?void 0:J.id:void 0,invitationCode:void 0},totalOrderAmount:0,totalFinalAmount:0});function ce(){const r=j.value,l=P.json_to_sheet(r);console.log(l);const s=P.book_new();P.book_append_sheet(s,l,"Sheet1");const n=Ee(s,{bookType:"xlsx",type:"binary"});function i(k){const N=new ArrayBuffer(k.length),I=new Uint8Array(N);for(let C=0;C!==k.length;++C)I[C]=k.charCodeAt(C)&255;return N}Ne.saveAs(new Blob([i(n)],{type:"application/octet-stream"}),"data.xlsx")}const{queryParams:u,form:st,rules:dt,rulesIv:it,formIv:pt,totalOrderAmount:H,totalFinalAmount:O}=Ae(pe);function b(){B.value=!0,Me(me(u.value,S.value,$.value)).then(r=>{B.value=!1,j.value=r.data.page.records,E.value=r.data.page.total,H.value=r.data.totalOrderAmount,O.value=r.data.totalFinalAmount,se()})}function me(r,l,s){let n=r;return n.params=typeof n.params=="object"&&n.params!==null&&!Array.isArray(n.params)?n.params:{},l=Array.isArray(l)?l:[],s=Array.isArray(s)?s:[],n.requestTimeStart=l[0]&&l[0]+" 00:00:00",n.requestTimeEnd=l[1]&&l[1]+" 23:59:59",n.operateTimeStart=s[0]&&s[0]+" 00:00:00",n.operateTimeEnd=s[1]&&s[1]+" 23:59:59",n}function x(){u.value.pageNo=1,b()}function _e(){S.value=[],$.value=[],T.resetForm("queryRef"),u.value.agentId=void 0,u.value.invitationCode=void 0,x()}function fe(r){const l=r.id;T.$modal.confirm("是否确定要通过该订单？此操作不可恢复").then(function(){return je({id:l})}).then(()=>{b(),T.$modal.msgSuccess("操作成功")}).catch(()=>{})}function ye(r){const l=r.id;T.$modal.confirm("是否确定要拒绝该订单？此操作不可恢复").then(function(){return Be({id:l})}).then(()=>{b(),T.$modal.msgSuccess("操作成功")}).catch(()=>{})}let h=r=>r<10?"0"+r:r;if(((G=(Z=M.currentRoute.value)==null?void 0:Z.query)==null?void 0:G.type)==1){let r=new Date,l=r.getFullYear(),s=r.getMonth()+1,n=r.getDate();r.getHours(),r.getMinutes(),r.getSeconds(),s>12&&(s=s-12),u.value.requestTimeStart=`${l}-${h(s)}-${h(n)} 00:00:00`,u.value.requestTimeEnd=`${l}-${h(s)}-${h(n)} 23:59:59`,S.value=[`${l}-${h(s)}-${h(n)}`,`${l}-${h(s)}-${h(n)}`]}const g=c(null);let V=null;const w=c(0);function ve(){V&&(clearInterval(V),V=null),g.value?(w.value=g.value/1e3,V=setInterval(()=>{w.value>0&&w.value--,w.value===0&&(b(),w.value=g.value/1e3)},1e3),b()):w.value=0}return De(()=>{V&&clearInterval(V)}),b(),(r,l)=>{const s=p("el-input"),n=p("el-form-item"),i=p("el-option"),k=p("el-select"),N=p("el-date-picker"),I=p("el-button"),C=p("el-form"),m=p("el-table-column"),X=p("CopyDocument"),ee=p("el-icon"),te=p("el-tooltip"),he=p("el-table"),be=p("pagination"),ge=p("el-col"),we=p("el-row"),le=oe("hasPermi"),ke=oe("loading");return d(),f("div",Le,[t(we,{gutter:20},{default:a(()=>[t(ge,{xs:24},{default:a(()=>[U(t(C,{model:o(u),ref:"queryRef",inline:!0,"label-width":"68px"},{default:a(()=>[t(n,{label:"记录ID",prop:"id"},{default:a(()=>[t(s,{oninput:"if(value.length>6)value=value.slice(0,6)",modelValue:o(u).id,"onUpdate:modelValue":l[0]||(l[0]=e=>o(u).id=e),placeholder:"请输入记录ID",clearable:"",style:{width:"150px"},onKeyup:F(x,["enter"])},null,8,["modelValue"])]),_:1}),t(n,{label:"会员查询",prop:"userId"},{default:a(()=>[t(s,{type:"number",oninput:"if(value.length>6)value=value.slice(0,6)",modelValue:o(u).userId,"onUpdate:modelValue":l[1]||(l[1]=e=>o(u).userId=e),placeholder:"请输入会员Id",clearable:"",style:{width:"150px"},onKeyup:F(x,["enter"])},null,8,["modelValue"])]),_:1}),t(n,{label:"所属代理",prop:"agentId"},{default:a(()=>[t(s,{modelValue:o(u).agentId,"onUpdate:modelValue":l[2]||(l[2]=e=>o(u).agentId=e),placeholder:"请输入代理id",clearable:"",style:{width:"150px"},onKeyup:F(x,["enter"])},null,8,["modelValue"])]),_:1}),t(n,{label:"订单号",prop:"orderSn"},{default:a(()=>[t(s,{modelValue:o(u).orderSn,"onUpdate:modelValue":l[3]||(l[3]=e=>o(u).orderSn=e),placeholder:"请输入订单号",clearable:"",style:{width:"190px"},onKeyup:F(x,["enter"])},null,8,["modelValue"])]),_:1}),t(n,{style:{width:"150px"},label:"充值方式",prop:"cashinTypeCode"},{default:a(()=>[t(k,{style:{width:"100%"},modelValue:o(u).cashinTypeCode,"onUpdate:modelValue":l[4]||(l[4]=e=>o(u).cashinTypeCode=e),placeholder:"全部"},{default:a(()=>[t(i,{key:"-1",label:"全部",value:""}),(d(!0),f(Te,null,$e(o(ie),e=>(d(),A(i,{key:e.code,label:e.name,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"订单状态",prop:"orderStatus"},{default:a(()=>[t(k,{modelValue:o(u).orderStatus,"onUpdate:modelValue":l[5]||(l[5]=e=>o(u).orderStatus=e),style:{width:"150px"},placeholder:"全部"},{default:a(()=>[t(i,{key:"-1",label:"全部",value:""}),t(i,{key:"0",label:"待审核",value:0}),t(i,{key:"1",label:"已通过",value:1}),t(i,{key:"2",label:"已取消",value:2})]),_:1},8,["modelValue"])]),_:1}),t(n,{label:"申请时间",style:{width:"308px"}},{default:a(()=>[t(N,{modelValue:o(S),"onUpdate:modelValue":l[6]||(l[6]=e=>K(S)?S.value=e:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),t(n,{label:"审核时间",style:{width:"308px"}},{default:a(()=>[t(N,{modelValue:o($),"onUpdate:modelValue":l[7]||(l[7]=e=>K($)?$.value=e:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),t(n,null,{default:a(()=>[t(I,{type:"primary",icon:"Search",onClick:x},{default:a(()=>[y("搜索")]),_:1}),t(I,{icon:"Refresh",onClick:_e},{default:a(()=>[y("重置")]),_:1}),t(I,{type:"primary",icon:"Download",onClick:ce},{default:a(()=>[y("导出搜索数据")]),_:1})]),_:1}),t(n,{label:"自动刷新"},{default:a(()=>[t(k,{modelValue:o(g),"onUpdate:modelValue":l[8]||(l[8]=e=>K(g)?g.value=e:null),onChange:ve,style:{width:"120px"},placeholder:"关闭"},{default:a(()=>[t(i,{label:"关闭",value:null}),t(i,{label:"5秒",value:5e3}),t(i,{label:"10秒",value:1e4}),t(i,{label:"30秒",value:3e4}),t(i,{label:"1分钟",value:6e4}),t(i,{label:"3分钟",value:18e4}),t(i,{label:"5分钟",value:3e5})]),_:1},8,["modelValue"]),o(g)?(d(),f("span",Ke,_(o(w))+" 秒后自动刷新",1)):D("",!0)]),_:1})]),_:1},8,["model"]),[[ne,o(de)]]),v("div",Pe,[v("div",ze,"申请金额合计:"+_(o(H)),1),v("div",He,"到账金额合计:"+_(o(O)),1)]),U((d(),A(he,{border:"",data:o(j),onHeaderDragend:o(ue),ref_key:"tableRef",ref:re},{default:a(()=>[t(m,{label:"记录ID",width:"90",align:"center",key:"id",prop:"id","show-overflow-tooltip":!0}),t(m,{label:"用户信息",align:"center",width:"150","show-overflow-tooltip":!0},{default:a(e=>[e.row.userId?(d(),f("span",Oe,[y(_(e.row.realName?e.row.realName:e.row.nickname),1),Re,y(" "+_(e.row.userId),1),t(ee,{style:{cursor:"pointer","margin-left":"4px"},onClick:L=>o(z)(e.row.userId)},{default:a(()=>[t(X)]),_:2},1032,["onClick"]),Qe,y(" L"+_(e.row.levelId)+"-"+_(e.row.levelName),1)])):(d(),f("span",We,"-"))]),_:1}),t(m,{label:"直属代理(ID)",width:"150",align:"center"},{default:a(e=>[e.row.agentId?(d(),f("span",Je,[y(_(e.row.agentName),1),Ze,y("（"+_(e.row.agentId)+"）",1)])):(d(),f("span",Ge,"-"))]),_:1}),t(m,{label:"团队总代(ID)",width:"150",align:"center"},{default:a(e=>[e.row.generalAgentId?(d(),f("span",Xe,[y(_(e.row.generalAgentName),1),et,y("（"+_(e.row.generalAgentId)+"）",1)])):(d(),f("span",tt,"-"))]),_:1}),t(m,{label:"订单号",width:"210",align:"center",key:"orderSn",prop:"orderSn"},{default:a(e=>[v("span",null,_(e.row.orderSn),1),t(ee,{style:{cursor:"pointer","margin-left":"4px"},onClick:L=>o(z)(e.row.orderSn)},{default:a(()=>[t(X)]),_:2},1032,["onClick"])]),_:1}),t(m,{label:"充值方式",width:"130",align:"center",key:"cashinTypeName",prop:"cashinTypeName","show-overflow-tooltip":!0},{default:a(e=>[v("span",lt,_(e.row.cashinTypeName),1)]),_:1}),t(m,{label:"申请金额",align:"center",key:"orderAmount",prop:"orderAmount"}),t(m,{label:"申请时间",align:"center",key:"requestTime",prop:"requestTime"}),t(m,{label:"审核时间",align:"center",key:"operateTime",prop:"operateTime"}),t(m,{label:"到账金额",align:"center",key:"finalAmount",prop:"finalAmount"}),t(m,{label:"订单状态",align:"center",key:"orderStatus",prop:"orderStatus"},{default:a(e=>[e.row.orderStatus==0?(d(),f("span",at,"审核中")):D("",!0),e.row.orderStatus==1?(d(),f("span",ot,"充值成功")):D("",!0),e.row.orderStatus==2?(d(),f("span",nt,"充值失败")):D("",!0)]),_:1}),t(m,{label:"操作人",align:"center",key:"operator",prop:"operator"}),t(m,{label:"操作",align:"center",width:"350","class-name":"small-padding fixed-width"},{default:a(e=>[e.row.orderStatus==0?(d(),A(te,{key:0,disabled:"true",content:"通过",placement:"top"},{default:a(()=>[U((d(),A(I,{type:"primary",onClick:L=>fe(e.row)},{default:a(()=>[y("通过")]),_:2},1032,["onClick"])),[[le,["cashinPass"]]])]),_:2},1024)):D("",!0),e.row.orderStatus==0?(d(),A(te,{key:1,disabled:"true",content:"拒绝",placement:"top"},{default:a(()=>[U((d(),A(I,{type:"danger",onClick:L=>ye(e.row)},{default:a(()=>[y("拒绝")]),_:2},1032,["onClick"])),[[le,["cashinReject"]]])]),_:2},1024)):D("",!0)]),_:1})]),_:1},8,["data","onHeaderDragend"])),[[ke,o(B)]]),U(t(be,{total:o(E),page:o(u).pageNo,"onUpdate:page":l[9]||(l[9]=e=>o(u).pageNo=e),onPagination:b,limit:o(u).pageSize,"onUpdate:limit":l[10]||(l[10]=e=>o(u).pageSize=e)},null,8,["total","page","limit"]),[[ne,o(E)>0]])]),_:1})]),_:1})])}}}),vt=Ie(ut,[["__scopeId","data-v-94a74bda"]]);export{vt as default};
