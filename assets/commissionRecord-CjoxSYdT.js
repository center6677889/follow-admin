import{P as ue,_ as ie,B as me,a as pe,d as ce,r as m,C as _e,I as fe,e as u,J as P,c as v,o as c,f as t,h as o,K as x,k as n,l as A,D as S,n as r,N,i as E,A as s,m as _,s as ge,t as be}from"./index-BXRoTRPN.js";import{u as ye}from"./useTableColumnWidth-CTSg-whZ.js";import{u as ve}from"./useCopy-CSzW9GjL.js";import we from"./rebateList-xTqF4fAI.js";function he(w){return ue({url:"/agent/rebate/list",method:"post",data:w})}const f=w=>(ge("data-v-c1d8783b"),w=w(),be(),w),Ie={class:"app-container"},ke={key:0},xe=f(()=>_("br",null,null,-1)),De=f(()=>_("br",null,null,-1)),Me={key:1},Ve={key:0},Ae=f(()=>_("br",null,null,-1)),Re={key:1},Le={key:0},Ce=f(()=>_("br",null,null,-1)),Fe={key:1},Pe=f(()=>_("br",null,null,-1)),Se=f(()=>_("br",null,null,-1)),Ne=f(()=>_("br",null,null,-1)),Ee=f(()=>_("br",null,null,-1)),Te={class:"dialog-footer",style:{"text-align":"center"}},Ue=me({name:"User"}),Ye=Object.assign(Ue,{setup(w){const{tableRef:T,handleHeaderDragend:U,applyStoredColumnWidths:Y}=ye("agent/commissionRecord-table"),{copyText:$}=ve();pe();const{proxy:B}=ce(),R=m([]);m(!1);const D=m(!0),q=m(!0),h=m(!1),M=m(0);m("");const g=m([]);m([]);const L=m(),C=m(),F=m(),H=_e({form:{},queryParams:{pageNo:1,pageSize:10,agentId:void 0,accountType:void 0,generalAgentId:void 0,userId:void 0,levelId:void 0,promotionEnable:void 0},tempInfo:{},bankform:{}}),{queryParams:i}=fe(H);function V(){D.value=!0,he(K(i.value,g.value)).then(a=>{D.value=!1,R.value=a.data.records,M.value=a.data.total,Y()})}function K(a,l){let d=a;return d.params=typeof d.params=="object"&&d.params!==null&&!Array.isArray(d.params)?d.params:{},l=Array.isArray(l)?l:[],d.startDate=l[0]&&l[0]+" 00:00:00",d.endDate=l[1]&&l[1]+" 23:59:59",d}function z(a){L.value=a.userId;let l=a.settlementDate.slice(0,10);C.value=l+" 00:00:00",F.value=l+" 23:59:59",h.value=!0}function b(){i.value.pageNo=1,V()}function j(){g.value=[],B.resetForm("queryRef"),b()}Date.prototype.Format=function(a){var l={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in l)new RegExp("("+d+")").test(a)&&(a=a.replace(RegExp.$1,RegExp.$1.length==1?l[d]:("00"+l[d]).substr((""+l[d]).length)));return a};function Q(){var a=new Date,l=new Date(a.getFullYear(),a.getMonth(),1).Format("yyyy-MM-dd"),d=new Date(a.getFullYear(),a.getMonth()+1,0,23,59,59).Format("yyyy-MM-dd");g.value=[l,d],b()}function W(){var a=new Date,l=new Date(a.getFullYear(),a.getMonth()-1,1).Format("yyyy-MM-dd"),d=new Date(a.getFullYear(),a.getMonth(),0,23,59,59).Format("yyyy-MM-dd");g.value=[l,d],b()}return V(),(a,l)=>{const d=u("el-input"),y=u("el-form-item"),I=u("el-option"),J=u("el-select"),O=u("el-date-picker"),k=u("el-button"),G=u("el-form"),X=u("CopyDocument"),Z=u("el-icon"),p=u("el-table-column"),ee=u("el-tooltip"),te=u("el-table"),le=u("pagination"),oe=u("el-col"),ae=u("el-row"),ne=u("el-dialog"),re=P("hasPermi"),de=P("loading");return c(),v("div",Ie,[t(ae,{gutter:20},{default:o(()=>[t(oe,{xs:24},{default:o(()=>[x(t(G,{model:n(i),ref:"queryRef",inline:!0,"label-width":"68px"},{default:o(()=>[t(y,{label:"会员查询",prop:"userId"},{default:o(()=>[t(d,{modelValue:n(i).userId,"onUpdate:modelValue":l[0]||(l[0]=e=>n(i).userId=e),modelModifiers:{number:!0},type:"number",placeholder:"请输入会员id",clearable:"",style:{width:"150px"},onKeyup:A(b,["enter"])},null,8,["modelValue"])]),_:1}),t(y,{label:"会员等级",prop:"userLevelVal"},{default:o(()=>[t(J,{modelValue:n(i).userLevelVal,"onUpdate:modelValue":l[1]||(l[1]=e=>n(i).userLevelVal=e),style:{width:"150px"},placeholder:"全部"},{default:o(()=>[t(I,{key:"0",label:"全部",value:""}),t(I,{key:"1",label:"L1-普通会员",value:1}),t(I,{key:"2",label:"L2-银牌",value:2}),t(I,{key:"3",label:"L3-金牌",value:3}),t(I,{key:"4",label:"L4-钻石",value:4}),t(I,{key:"5",label:"L5-皇冠",value:5})]),_:1},8,["modelValue"])]),_:1}),t(y,{label:"直属代理",prop:"agentId"},{default:o(()=>[t(d,{modelValue:n(i).agentId,"onUpdate:modelValue":l[2]||(l[2]=e=>n(i).agentId=e),modelModifiers:{number:!0},type:"number",placeholder:"请输入直属代理id",clearable:"",style:{width:"150px"},onKeyup:A(b,["enter"])},null,8,["modelValue"])]),_:1}),t(y,{label:"团队总代",prop:"generalAgentId"},{default:o(()=>[t(d,{modelValue:n(i).generalAgentId,"onUpdate:modelValue":l[3]||(l[3]=e=>n(i).generalAgentId=e),modelModifiers:{number:!0},type:"number",placeholder:"请输入团队总代会员id",clearable:"",style:{width:"160px"},onKeyup:A(b,["enter"])},null,8,["modelValue"])]),_:1}),t(y,{label:"结算时间",style:{width:"308px"}},{default:o(()=>[t(O,{modelValue:n(g),"onUpdate:modelValue":l[4]||(l[4]=e=>S(g)?g.value=e:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),t(y,null,{default:o(()=>[t(k,{type:"primary",icon:"Search",onClick:b},{default:o(()=>[r("搜索")]),_:1}),t(k,{icon:"Refresh",onClick:j},{default:o(()=>[r("重置")]),_:1})]),_:1}),t(y,{label:"快捷查询",prop:"userId"},{default:o(()=>[t(k,{onClick:Q},{default:o(()=>[r("本月")]),_:1}),t(k,{onClick:W},{default:o(()=>[r("上月")]),_:1})]),_:1})]),_:1},8,["model"]),[[N,n(q)]]),x((c(),E(te,{border:"",data:n(R),onHeaderDragend:n(U),ref_key:"tableRef",ref:T},{default:o(()=>[t(p,{label:"用户信息",align:"center",width:"150","show-overflow-tooltip":!0},{default:o(e=>[e.row.userId?(c(),v("span",ke,[r(s(e.row.realName?e.row.realName:e.row.nickname)+" ",1),xe,r(" "+s(e.row.userId),1),t(Z,{style:{cursor:"pointer","margin-left":"4px"},onClick:se=>n($)(e.row.userId)},{default:o(()=>[t(X)]),_:2},1032,["onClick"]),De,r(" L"+s(e.row.userLevelVal)+"-"+s(e.row.userLevelName),1)])):(c(),v("span",Me,"-"))]),_:1}),t(p,{label:"直属代理(ID)",align:"center"},{default:o(e=>[e.row.agentId?(c(),v("span",Ve,[r(s(e.row.agentName),1),Ae,r("（"+s(e.row.agentId)+"）",1)])):(c(),v("span",Re,"-"))]),_:1}),t(p,{label:"团队总代(ID)",align:"center"},{default:o(e=>[e.row.generalAgentId?(c(),v("span",Le,[r(s(e.row.generalAgentName),1),Ce,r("（"+s(e.row.generalAgentId)+"）",1)])):(c(),v("span",Fe,"-"))]),_:1}),t(p,{label:"L1-普通会员",align:"center"},{default:o(e=>[r(" 业绩："+s(e.row.lv1Performance&&e.row.lv1Performance.toFixed(2))+" ",1),Pe,r(" 返佣金额："+s(e.row.lv1RebateAmount&&e.row.lv1RebateAmount.toFixed(2)),1)]),_:1}),t(p,{label:"L2-银牌",align:"center"},{default:o(e=>[r(" 业绩："+s(e.row.lv2Performance&&e.row.lv2Performance.toFixed(2))+" ",1),Se,r(" 返佣金额："+s(e.row.lv2RebateAmount&&e.row.lv2RebateAmount.toFixed(2)),1)]),_:1}),t(p,{label:"L3-金牌",align:"center"},{default:o(e=>[r(" 业绩："+s(e.row.lv3Performance&&e.row.lv3Performance.toFixed(2))+" ",1),Ne,r(" 返佣金额："+s(e.row.lv3RebateAmount&&e.row.lv3RebateAmount.toFixed(2)),1)]),_:1}),t(p,{label:"L4-钻石",align:"center"},{default:o(e=>[r(" 业绩："+s(e.row.lv4Performance&&e.row.lv4Performance.toFixed(2))+" ",1),Ee,r(" 返佣金额："+s(e.row.lv4RebateAmount&&e.row.lv4RebateAmount.toFixed(2)),1)]),_:1}),t(p,{label:"返佣总金额",align:"center",key:"totalRebateAmount",prop:"totalRebateAmount","show-overflow-tooltip":!0}),t(p,{label:"总业绩",align:"center",key:"totalPerformance",prop:"totalPerformance","show-overflow-tooltip":!0}),t(p,{label:"结算时间",align:"center"},{default:o(e=>[r(s(e.row.settlementDate.slice(0,10)),1)]),_:1}),t(p,{fixed:"right",label:"操作",align:"center",width:"150","class-name":"small-padding fixed-width"},{default:o(e=>[t(ee,{disabled:"true",content:"返佣明细",placement:"top"},{default:o(()=>[x((c(),E(k,{type:"primary",onClick:se=>z(e.row)},{default:o(()=>[r("返佣明细")]),_:2},1032,["onClick"])),[[re,["rakeBack"]]])]),_:2},1024)]),_:1})]),_:1},8,["data","onHeaderDragend"])),[[de,n(D)]]),x(t(le,{total:n(M),onPagination:V,page:n(i).pageNo,"onUpdate:page":l[5]||(l[5]=e=>n(i).pageNo=e),limit:n(i).pageSize,"onUpdate:limit":l[6]||(l[6]=e=>n(i).pageSize=e)},null,8,["total","page","limit"]),[[N,n(M)>0]])]),_:1})]),_:1}),t(ne,{title:"返佣明细",width:"85%",modelValue:n(h),"onUpdate:modelValue":l[8]||(l[8]=e=>S(h)?h.value=e:null),"append-to-body":""},{footer:o(()=>[_("div",Te,[t(k,{type:"primary",onClick:l[7]||(l[7]=e=>h.value=!1)},{default:o(()=>[r("确定")]),_:1})])]),default:o(()=>[t(we,{userId:n(L),startTime:n(C),endTime:n(F),open:n(h)},null,8,["userId","startTime","endTime","open"])]),_:1},8,["modelValue"])])}}}),Ke=ie(Ye,[["__scopeId","data-v-c1d8783b"]]);export{Ke as default};
