import{W}from"./userAvatar.vue_vue_type_style_index_0_scoped_51bd080c_lang-BvKJq7RV.js";import{v as A}from"./user-Dhl3jA1d.js";import{_ as H,b as L,d as O,r as _,C as P,e as i,c as q,o as h,m as c,f as t,k as l,h as a,i as E,j as F,a0 as G,n as x,D as j,s as z,t as J}from"./index-BXRoTRPN.js";const M=f=>(z("data-v-51bd080c"),f=f(),J(),f),K=["src"],Q={class:"avatar-upload-preview"},X=["src"],Y=M(()=>c("br",null,null,-1)),Z={__name:"userAvatar",setup(f){const m=L(),{proxy:p}=O(),d=_(!1),g=_(!1),y=_("修改头像"),o=P({img:m.avatar,autoCrop:!0,autoCropWidth:200,autoCropHeight:200,fixedBox:!0,outputType:"png",filename:"avatar",previews:{}});function w(){d.value=!0}function b(){g.value=!0}function $(){}function k(){p.$refs.cropper.rotateLeft()}function B(){p.$refs.cropper.rotateRight()}function v(n){n=n||1,p.$refs.cropper.changeScale(n)}function R(n){if(n.type.indexOf("image/")==-1)p.$modal.msgError("文件格式错误，请上传图片类型,如：JPG，PNG后缀的文件。");else{const e=new FileReader;e.readAsDataURL(n),e.onload=()=>{o.img=e.result,o.filename=n.name}}}function S(){p.$refs.cropper.getCropBlob(n=>{let e=new FormData;e.append("avatarfile",n,o.filename),A(e).then(s=>{d.value=!1,o.img="/prod-api"+s.imgUrl,m.avatar=o.img,p.$modal.msgSuccess("修改成功"),g.value=!1})})}function U(n){o.previews=n}function T(){o.img=m.avatar,o.visible=!1}return(n,e)=>{const s=i("el-col"),C=i("el-row"),V=i("Upload"),I=i("el-icon"),u=i("el-button"),D=i("el-upload"),N=i("el-dialog");return h(),q("div",{class:"user-info-head",onClick:e[6]||(e[6]=r=>w())},[c("img",{src:l(o).img,title:"点击上传头像",class:"img-circle img-lg"},null,8,K),t(N,{title:l(y),modelValue:l(d),"onUpdate:modelValue":e[5]||(e[5]=r=>j(d)?d.value=r:null),width:"800px","append-to-body":"",onOpened:b,onClose:T},{default:a(()=>[t(C,null,{default:a(()=>[t(s,{xs:24,md:12,style:{height:"350px"}},{default:a(()=>[l(g)?(h(),E(l(W),{key:0,ref:"cropper",img:l(o).img,info:!0,autoCrop:l(o).autoCrop,autoCropWidth:l(o).autoCropWidth,autoCropHeight:l(o).autoCropHeight,fixedBox:l(o).fixedBox,outputType:l(o).outputType,onRealTime:U},null,8,["img","autoCrop","autoCropWidth","autoCropHeight","fixedBox","outputType"])):F("",!0)]),_:1}),t(s,{xs:24,md:12,style:{height:"350px"}},{default:a(()=>[c("div",Q,[c("img",{src:l(o).previews.url,style:G(l(o).previews.img)},null,12,X)])]),_:1})]),_:1}),Y,t(C,null,{default:a(()=>[t(s,{lg:2,md:2},{default:a(()=>[t(D,{action:"#","http-request":$,"show-file-list":!1,"before-upload":R},{default:a(()=>[t(u,null,{default:a(()=>[x(" 选择 "),t(I,{class:"el-icon--right"},{default:a(()=>[t(V)]),_:1})]),_:1})]),_:1})]),_:1}),t(s,{lg:{span:1,offset:2},md:2},{default:a(()=>[t(u,{icon:"Plus",onClick:e[0]||(e[0]=r=>v(1))})]),_:1}),t(s,{lg:{span:1,offset:1},md:2},{default:a(()=>[t(u,{icon:"Minus",onClick:e[1]||(e[1]=r=>v(-1))})]),_:1}),t(s,{lg:{span:1,offset:1},md:2},{default:a(()=>[t(u,{icon:"RefreshLeft",onClick:e[2]||(e[2]=r=>k())})]),_:1}),t(s,{lg:{span:1,offset:1},md:2},{default:a(()=>[t(u,{icon:"RefreshRight",onClick:e[3]||(e[3]=r=>B())})]),_:1}),t(s,{lg:{span:2,offset:6},md:2},{default:a(()=>[t(u,{type:"primary",onClick:e[4]||(e[4]=r=>S())},{default:a(()=>[x("提 交")]),_:1})]),_:1})]),_:1})]),_:1},8,["title","modelValue"])])}}},ae=H(Z,[["__scopeId","data-v-51bd080c"]]);export{ae as default};
