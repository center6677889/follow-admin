import{_ as Z,B as ee,a as te,d as oe,r as u,C as x,H as ae,I as le,e as s,J as ne,c as h,o as i,f as t,h as l,K as k,k as a,l as S,D as re,L as se,M as ue,i as L,n as f,N as M,A as c,m,s as de,t as pe}from"./index-BXRoTRPN.js";import{u as ie}from"./useTableColumnWidth-CTSg-whZ.js";import{u as ce}from"./useCopy-CSzW9GjL.js";import{k as me}from"./user-Dhl3jA1d.js";const U=y=>(de("data-v-f93bc97d"),y=y(),pe(),y),_e={class:"app-container"},fe={key:0},ye=U(()=>m("br",null,null,-1)),ge=U(()=>m("br",null,null,-1)),he={key:1},we=["innerHTML"],be=["innerHTML"],ve=ee({name:"User"}),Ce=Object.assign(ve,{setup(y){const{tableRef:H,handleHeaderDragend:A,applyStoredColumnWidths:B}=ie("system/user/userUp-table"),{copyText:K}=ce();te();const{proxy:D}=oe(),I=u([]);u(!1),u(!1);const w=u(!0),P=u(!0);u([]),u(!0),u(!0);const b=u(0);u("");const _=u([]),R=x(ae().userDataChageType),q=x({form:{},formIv:{},queryParams:{pageNo:1,pageSize:10,userId:void 0,ip:void 0,userDataChangeTypeCode:void 0}}),{queryParams:n,form:ke,rules:De,rulesIv:Ie,formIv:Te}=le(q);function v(){w.value=!0,me(Y(n.value,_.value)).then(d=>{w.value=!1,I.value=d.data.records,b.value=d.data.total,B()})}function Y(d,o,C){let r=d;return r.params=typeof r.params=="object"&&r.params!==null&&!Array.isArray(r.params)?r.params:{},o=Array.isArray(o)?o:[],r.createTimeStart=o[0]&&o[0]+" 00:00:00",r.createTimeEnd=o[1]&&o[1]+" 23:59:59",r}function g(){n.value.pageNo=1,v()}function T(d){return console.log(d),d?d.replace(/\n/g,"<br>"):""}function z(){_.value=[],D.resetForm("queryRef"),n.value.userId=void 0,n.value.ip=void 0,n.value.userDataChangeTypeCode=void 0,D.$refs.deptTreeRef.setCurrentKey(null),g()}return v(),(d,o)=>{const C=s("el-input"),r=s("el-form-item"),E=s("el-date-picker"),N=s("el-option"),j=s("el-select"),V=s("el-button"),F=s("el-form"),p=s("el-table-column"),Q=s("CopyDocument"),W=s("el-icon"),$=s("el-table"),J=s("pagination"),O=s("el-col"),G=s("el-row"),X=ne("loading");return i(),h("div",_e,[t(G,{gutter:20},{default:l(()=>[t(O,{xs:24},{default:l(()=>[k(t(F,{model:a(n),ref:"queryRef",inline:!0,"label-width":"68px"},{default:l(()=>[t(r,{label:"记录ID",prop:"id"},{default:l(()=>[t(C,{modelValue:a(n).id,"onUpdate:modelValue":o[0]||(o[0]=e=>a(n).id=e),modelModifiers:{number:!0},type:"number",placeholder:"请输入记录ID",clearable:"",style:{width:"160px"},onKeyup:S(g,["enter"])},null,8,["modelValue"])]),_:1}),t(r,{label:"会员查询",prop:"userId"},{default:l(()=>[t(C,{modelValue:a(n).userId,"onUpdate:modelValue":o[1]||(o[1]=e=>a(n).userId=e),modelModifiers:{number:!0},type:"number",placeholder:"请输入会员id",clearable:"",style:{width:"160px"},onKeyup:S(g,["enter"])},null,8,["modelValue"])]),_:1}),t(r,{label:"变更时间",style:{width:"308px"}},{default:l(()=>[t(E,{modelValue:a(_),"onUpdate:modelValue":o[2]||(o[2]=e=>re(_)?_.value=e:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),t(r,{style:{width:"240px"},label:"变更类型",prop:"userDataChangeTypeCode"},{default:l(()=>[t(j,{style:{width:"100%"},modelValue:a(n).userDataChangeTypeCode,"onUpdate:modelValue":o[3]||(o[3]=e=>a(n).userDataChangeTypeCode=e),placeholder:"全部"},{default:l(()=>[t(N,{key:"-1",label:"全部",value:""}),(i(!0),h(se,null,ue(a(R),e=>(i(),L(N,{key:e.code,label:e.name,value:e.code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(r,null,{default:l(()=>[t(V,{type:"primary",icon:"Search",onClick:g},{default:l(()=>[f("搜索")]),_:1}),t(V,{icon:"Refresh",onClick:z},{default:l(()=>[f("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[M,a(P)]]),k((i(),L($,{border:"",data:a(I),onHeaderDragend:a(A),ref_key:"tableRef",ref:H},{default:l(()=>[t(p,{label:"记录ID",align:"center",key:"id",prop:"id"}),t(p,{label:"用户信息",align:"center",width:"150","show-overflow-tooltip":!0},{default:l(e=>[e.row.userId?(i(),h("span",fe,[f(c(e.row.realName?e.row.realName:e.row.nickname)+" ",1),ye,f(" "+c(e.row.userId),1),t(W,{style:{cursor:"pointer","margin-left":"4px"},onClick:Ne=>a(K)(e.row.userId)},{default:l(()=>[t(Q)]),_:2},1032,["onClick"]),ge,f(" L"+c(e.row.levelId)+"-"+c(e.row.levelName),1)])):(i(),h("span",he,"-"))]),_:1}),t(p,{label:"变更时间",align:"center",key:"createTime",prop:"createTime","show-overflow-tooltip":!0},{default:l(e=>[m("span",null,c(e.row.createTime),1)]),_:1}),t(p,{label:"变更类型",align:"center",key:"dataChangeTypeName",prop:"dataChangeTypeName","show-overflow-tooltip":!0},{default:l(e=>[m("span",null,c(e.row.dataChangeTypeName),1)]),_:1}),t(p,{label:"原始值",width:"300",align:"center",key:"oldContent",prop:"oldContent","show-overflow-tooltip":!0},{default:l(e=>[m("div",{innerHTML:T(e.row.oldContent)},null,8,we)]),_:1}),t(p,{label:"变更值",width:"300",align:"center",key:"newContent",prop:"newContent","show-overflow-tooltip":!0},{default:l(e=>[m("div",{innerHTML:T(e.row.newContent)},null,8,be)]),_:1}),t(p,{label:"变更人",align:"center",key:"operator",prop:"operator"}),t(p,{label:"IP",align:"center",key:"ip",prop:"ip"}),t(p,{label:"IP归属",align:"center",key:"ipAddress",prop:"ipAddress"})]),_:1},8,["data","onHeaderDragend"])),[[X,a(w)]]),k(t(J,{total:a(b),page:a(n).pageNo,"onUpdate:page":o[4]||(o[4]=e=>a(n).pageNo=e),onPagination:v,limit:a(n).pageSize,"onUpdate:limit":o[5]||(o[5]=e=>a(n).pageSize=e)},null,8,["total","page","limit"]),[[M,a(b)>0]])]),_:1})]),_:1})])}}}),Me=Z(Ce,[["__scopeId","data-v-f93bc97d"]]);export{Me as default};
