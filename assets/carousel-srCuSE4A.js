import{P as k,_ as ie,B as ce,a as pe,d as me,r as u,C as fe,I as _e,e as n,J as I,c as T,o as g,f as e,h as t,K as y,i as b,n as S,k as l,m as q,A as ge,N as he,p as ve,D as we}from"./index-BXRoTRPN.js";import{u as ye}from"./useTableColumnWidth-CTSg-whZ.js";function be(c){return k({url:"/system/carousel/add",method:"post",data:c})}function Se(c){return k({url:"/system/carousel/delete",headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"post",data:c})}function A(c){return k({url:"/system/carousel/edit",method:"post",data:c})}function ke(c){return k({url:"/system/carousel/list",headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"post",data:c})}const Ce={class:"app-container"},De=["src"],Ve={class:"dialog-footer"},xe=ce({name:"User"}),Ne=Object.assign(xe,{setup(c){const{tableRef:B,handleHeaderDragend:J,applyStoredColumnWidths:O}=ye("carousel-table");pe();const{proxy:p}=me(),U=u([]),i=u(!1);u(!1);const C=u(!0);u(!0);const P=u([]);u(!0),u(!0);const D=u(0),V=u(""),z=u([]),F=u(""),H=fe({form:{},queryParams:{pageNo:1,pageSize:10,agentId:void 0,agentName:void 0,generalParentId:void 0,parentId:void 0},rules:{isShow:[{required:!0,message:"请选择是否显示",trigger:"change"}],imageData:[{required:!0,message:"图片不能为空",trigger:"change"}],sort:[{required:!0,message:"排序不能为空",trigger:"blur"}]}}),{queryParams:v,form:s,rules:L}=_e(H);function W(r){return new Promise((o,f)=>{let d=new FileReader;d.readAsDataURL(r),d.onload=function(){s.value.imageData=d.result},d.onerror=function(_){f(_)},d.onloadend=function(){o(F.value)}})}function m(){C.value=!0,ke(p.addDateRange(v.value,z.value)).then(r=>{C.value=!1,U.value=r.data.records,D.value=r.data.total,O()})}function j(r){const o=r.id;p.$modal.confirm("是否确定删除该条轮播图？该操作不可撤回").then(function(){return Se({id:o})}).then(()=>{m(),p.$modal.msgSuccess("删除成功")}).catch(()=>{})}function x(){s.value={},p.resetForm("userRef")}function K(){i.value=!1}function M(){x(),i.value=!0,V.value="添加轮播图"}function G(r){x(),r.id||P.value,s.value=JSON.parse(JSON.stringify(r)),i.value=!0,V.value="修改轮播图"}function Q(r){x(),r.id||P.value,s.value=JSON.parse(JSON.stringify(r)),A(s.value).then(o=>{p.$modal.msgSuccess("修改成功"),i.value=!1,m()}).catch(o=>{m()})}function X(){p.$refs.userRef.validate(r=>{r&&(s.value.id!=null?A(s.value).then(o=>{p.$modal.msgSuccess("修改成功"),i.value=!1,m()}):be(s.value).then(o=>{p.$modal.msgSuccess("新增成功"),i.value=!1,m()}))})}return m(),(r,o)=>{const f=n("el-button"),d=n("el-col"),_=n("el-row"),h=n("el-table-column"),Y=n("el-image"),Z=n("el-switch"),E=n("el-tooltip"),ee=n("el-table"),te=n("pagination"),ae=n("el-input"),N=n("el-form-item"),$=n("el-option"),le=n("el-select"),oe=n("Plus"),ne=n("el-icon"),se=n("el-upload"),re=n("el-form"),ue=n("el-dialog"),R=I("hasPermi"),de=I("loading");return g(),T("div",Ce,[e(_,{gutter:20},{default:t(()=>[e(d,{xs:24},{default:t(()=>[y((g(),b(_,{gutter:10,class:"mb8"},{default:t(()=>[e(d,{span:1.5},{default:t(()=>[e(f,{type:"primary",plain:"",icon:"Plus",onClick:M},{default:t(()=>[S("添加轮播图")]),_:1})]),_:1})]),_:1})),[[R,["carouselAdd"]]]),y((g(),b(ee,{border:"",data:l(U),onHeaderDragend:l(J),ref_key:"tableRef",ref:B},{default:t(()=>[e(h,{label:"排序",align:"center",key:"sort",prop:"sort","show-overflow-tooltip":!0},{default:t(a=>[q("span",null,ge(a.row.sort),1)]),_:1}),e(h,{label:"图片",width:"400",align:"center",key:"title",prop:"title","show-overflow-tooltip":!0},{default:t(a=>[e(Y,{style:{height:"100px"},src:a.row.imageData,fit:"fill"},null,8,["src"])]),_:1}),e(h,{label:"是否显示",width:"100",align:"center",key:"isShow",prop:"isShow"},{default:t(a=>[e(Z,{size:"large",onChange:w=>Q(a.row,w),modelValue:a.row.isShow,"onUpdate:modelValue":w=>a.row.isShow=w},null,8,["onChange","modelValue","onUpdate:modelValue"])]),_:1}),e(h,{label:"添加时间",align:"center",key:"addTime",prop:"addTime"}),e(h,{label:"创建人",align:"center",key:"creator",prop:"creator"}),e(h,{label:"操作",align:"center",width:"200","class-name":"small-padding fixed-width"},{default:t(a=>[e(E,{disabled:"true",content:"编辑",placement:"top"},{default:t(()=>[y((g(),b(f,{type:"primary",onClick:w=>G(a.row)},{default:t(()=>[S("编辑")]),_:2},1032,["onClick"])),[[R,["carouselEdit"]]])]),_:2},1024),e(E,{disabled:"true",content:"删除",placement:"top"},{default:t(()=>[y((g(),b(f,{type:"danger",onClick:w=>j(a.row)},{default:t(()=>[S("删除")]),_:2},1032,["onClick"])),[[R,["carouselDelete"]]])]),_:2},1024)]),_:1})]),_:1},8,["data","onHeaderDragend"])),[[de,l(C)]]),y(e(te,{total:l(D),page:l(v).pageNo,"onUpdate:page":o[0]||(o[0]=a=>l(v).pageNo=a),onPagination:m,limit:l(v).pageSize,"onUpdate:limit":o[1]||(o[1]=a=>l(v).pageSize=a)},null,8,["total","page","limit"]),[[he,l(D)>0]])]),_:1})]),_:1}),e(ue,{title:l(V),modelValue:l(i),"onUpdate:modelValue":o[4]||(o[4]=a=>we(i)?i.value=a:null),width:"600px","append-to-body":""},{footer:t(()=>[q("div",Ve,[e(f,{type:"primary",onClick:X},{default:t(()=>[S("确 定")]),_:1}),e(f,{onClick:ve(K,["stop"])},{default:t(()=>[S("取 消")]),_:1})])]),default:t(()=>[e(re,{model:l(s),rules:l(L),ref:"userRef","label-width":"80px"},{default:t(()=>[e(_,null,{default:t(()=>[e(d,{span:24},{default:t(()=>[e(N,{label:"排序",prop:"sort"},{default:t(()=>[e(ae,{modelValue:l(s).sort,"onUpdate:modelValue":o[2]||(o[2]=a=>l(s).sort=a),placeholder:"请输入排序",type:"number",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(d,{span:24},{default:t(()=>[e(N,{label:"是否显示",prop:"isShow"},{default:t(()=>[e(le,{modelValue:l(s).isShow,"onUpdate:modelValue":o[3]||(o[3]=a=>l(s).isShow=a),placeholder:"全部"},{default:t(()=>[e($,{key:"1",label:"显示",value:!0}),e($,{key:"2",label:"隐藏",value:!1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(_,null,{default:t(()=>[e(d,{span:24},{default:t(()=>[e(N,{label:"轮播图片",prop:"imageData"},{default:t(()=>[e(se,{class:"avatar-uploader",style:{"background-color":"#EEEEEE"},action:"/","show-file-list":!1,"before-upload":W},{default:t(()=>[l(s).imageData?(g(),T("img",{key:0,style:{"max-width":"100%"},src:l(s).imageData,class:"avatar"},null,8,De)):(g(),b(ne,{key:1,class:"avatar-uploader-icon"},{default:t(()=>[e(oe)]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}}),Pe=ie(Ne,[["__scopeId","data-v-e2556a19"]]);export{Pe as default};
