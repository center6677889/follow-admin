import{_ as F,B as J,a as O,d as G,r as u,C as X,I as Z,e as s,J as ee,c as I,o as w,f as t,h as a,K as k,k as l,l as C,D as te,n as _,N as U,i as oe,A as i,m as d,s as le,t as ae}from"./index-BXRoTRPN.js";import{u as re}from"./useTableColumnWidth-CTSg-whZ.js";import{u as ne}from"./useCopy-CSzW9GjL.js";import{p as se}from"./user-Dhl3jA1d.js";const A=y=>(le("data-v-781db509"),y=y(),ae(),y),ue={class:"app-container"},pe={key:0},ie=A(()=>d("br",null,null,-1)),de=A(()=>d("br",null,null,-1)),ce={key:1},me=J({name:"User"}),fe=Object.assign(me,{setup(y){const{tableRef:P,handleHeaderDragend:q,applyStoredColumnWidths:K}=re("system/user/userLog-table"),{copyText:x}=ne();O();const{proxy:D}=G(),S=u([]);u(!1),u(!1);const v=u(!0),L=u(!0);u([]),u(!0),u(!0);const b=u(0);u("");const c=u([]),B=X({form:{},formIv:{},queryParams:{pageNo:1,pageSize:10,userId:void 0,ip:void 0}}),{queryParams:r,form:_e,rules:ye,rulesIv:ge,formIv:we}=Z(B);function h(){v.value=!0,se(R(r.value,c.value)).then(f=>{v.value=!1,S.value=f.data.records,b.value=f.data.total,K()})}function R(f,o,g){let n=f;return n.params=typeof n.params=="object"&&n.params!==null&&!Array.isArray(n.params)?n.params:{},o=Array.isArray(o)?o:[],n.startTime=o[0]&&o[0]+" 00:00:00",n.endTime=o[1]&&o[1]+" 23:59:59",n}function m(){r.value.pageNo=1,h()}function Y(){c.value=[],D.resetForm("queryRef"),r.value.userId=void 0,r.value.ip=void 0,D.$refs.deptTreeRef.setCurrentKey(null),m()}return h(),(f,o)=>{const g=s("el-input"),n=s("el-form-item"),$=s("el-date-picker"),V=s("el-button"),z=s("el-form"),p=s("el-table-column"),N=s("CopyDocument"),T=s("el-icon"),H=s("el-table"),M=s("pagination"),j=s("el-col"),Q=s("el-row"),W=ee("loading");return w(),I("div",ue,[t(Q,{gutter:20},{default:a(()=>[t(j,{xs:24},{default:a(()=>[k(t(z,{model:l(r),ref:"queryRef",inline:!0,"label-width":"68px"},{default:a(()=>[t(n,{label:"记录ID",prop:"id"},{default:a(()=>[t(g,{modelValue:l(r).id,"onUpdate:modelValue":o[0]||(o[0]=e=>l(r).id=e),modelModifiers:{number:!0},type:"number",placeholder:"请输入记录ID",clearable:"",style:{width:"160px"},onKeyup:C(m,["enter"])},null,8,["modelValue"])]),_:1}),t(n,{label:"会员查询",prop:"userId"},{default:a(()=>[t(g,{oninput:"if(value.length>6)value=value.slice(0,6)",modelValue:l(r).userId,"onUpdate:modelValue":o[1]||(o[1]=e=>l(r).userId=e),type:"number",placeholder:"请输入会员id",clearable:"",style:{width:"240px"},onKeyup:C(m,["enter"])},null,8,["modelValue"])]),_:1}),t(n,{label:"登录IP",prop:"ip"},{default:a(()=>[t(g,{modelValue:l(r).ip,"onUpdate:modelValue":o[2]||(o[2]=e=>l(r).ip=e),placeholder:"请输入登录IP",clearable:"",style:{width:"240px"},onKeyup:C(m,["enter"])},null,8,["modelValue"])]),_:1}),t(n,{label:"登录时间",style:{width:"308px"}},{default:a(()=>[t($,{modelValue:l(c),"onUpdate:modelValue":o[3]||(o[3]=e=>te(c)?c.value=e:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),t(n,null,{default:a(()=>[t(V,{type:"primary",icon:"Search",onClick:m},{default:a(()=>[_("搜索")]),_:1}),t(V,{icon:"Refresh",onClick:Y},{default:a(()=>[_("重置")]),_:1})]),_:1})]),_:1},8,["model"]),[[U,l(L)]]),k((w(),oe(H,{border:"",data:l(S),onHeaderDragend:l(q),ref_key:"tableRef",ref:P},{default:a(()=>[t(p,{label:"记录ID",align:"center",key:"id",prop:"id"}),t(p,{label:"用户信息",align:"center",width:"150","show-overflow-tooltip":!0},{default:a(e=>[e.row.userId?(w(),I("span",pe,[_(i(e.row.realName?e.row.realName:e.row.nickname)+" ",1),ie,_(" "+i(e.row.userId),1),t(T,{style:{cursor:"pointer","margin-left":"4px"},onClick:E=>l(x)(e.row.userId)},{default:a(()=>[t(N)]),_:2},1032,["onClick"]),de,_(" L"+i(e.row.levelId)+"-"+i(e.row.levelName),1)])):(w(),I("span",ce,"-"))]),_:1}),t(p,{label:"登录IP",align:"center",key:"ip",prop:"ip",width:"200","show-overflow-tooltip":!0},{default:a(e=>[d("span",null,i(e.row.ip),1),t(T,{style:{cursor:"pointer","margin-left":"4px"},onClick:E=>l(x)(e.row.ip)},{default:a(()=>[t(N)]),_:2},1032,["onClick"])]),_:1}),t(p,{label:"IP地址详情",align:"center",key:"ipAddress",prop:"ipAddress","show-overflow-tooltip":!0},{default:a(e=>[d("span",null,i(e.row.ipAddress),1)]),_:1}),t(p,{label:"登录类型",align:"center",key:"loginType",prop:"loginType","show-overflow-tooltip":!0},{default:a(e=>[d("span",null,i(e.row.loginType==0?"登录":"登出"),1)]),_:1}),t(p,{label:"登录状态",align:"center",key:"operateStatus",prop:"operateStatus","show-overflow-tooltip":!0},{default:a(e=>[d("span",null,i(e.row.operateStatus==0?"成功":e.row.operateStatus==1?"密码错误":"登录失败"),1)]),_:1}),t(p,{label:"访问域名",align:"center",key:"requestUrl",prop:"requestUrl"}),t(p,{label:"登录时间",align:"center",key:"operateTime",prop:"operateTime"})]),_:1},8,["data","onHeaderDragend"])),[[W,l(v)]]),k(t(M,{total:l(b),page:l(r).pageNo,"onUpdate:page":o[4]||(o[4]=e=>l(r).pageNo=e),onPagination:h,limit:l(r).pageSize,"onUpdate:limit":o[5]||(o[5]=e=>l(r).pageSize=e)},null,8,["total","page","limit"]),[[U,l(b)>0]])]),_:1})]),_:1})])}}}),ke=F(fe,[["__scopeId","data-v-781db509"]]);export{ke as default};
