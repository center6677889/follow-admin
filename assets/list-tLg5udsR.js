import{P as j,_ as Se,B as xe,a as Ce,d as Ve,r as g,C as z,I as Fe,O as De,e as f,J as le,c as i,o as a,f as t,h as l,K as V,k as n,l as R,n as r,D as Y,j as _,A as s,N as oe,i as F,m as c,s as Te,t as Pe}from"./index-BXRoTRPN.js";import{u as $e}from"./useTableColumnWidth-CTSg-whZ.js";import{u as Ne}from"./useCopy-CSzW9GjL.js";import{_ as Ae}from"./index-pTY-mJ8b.js";import{_ as Oe}from"./index-DxhvaFtQ.js";import"./user-Dhl3jA1d.js";function Re(h){return j({url:"/position/pending/list",method:"post",data:h})}function Ue(h){return j({url:"/position/pending/transferDetail",method:"post",data:h,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}function Ee(h){return j({url:"/position/pending/reject",method:"post",data:h})}function ne(h){return j({url:"/position/pending/transferPosition",method:"post",data:h})}const b=h=>(Te("data-v-6fe3a072"),h=h(),Pe(),h),Ke={class:"app-container"},He={key:0,style:{"margin-left":"8px",color:"#409EFF"}},je={key:0},qe=b(()=>c("br",null,null,-1)),Be=b(()=>c("br",null,null,-1)),Le={key:1},ze={key:0},Ye=b(()=>c("br",null,null,-1)),Me={key:1},Qe={key:0},We=b(()=>c("br",null,null,-1)),Je={key:1},Ge={key:0},Xe={key:1},Ze={class:"green"},et={key:0,class:"red"},tt={key:1,class:"red"},lt={key:2,class:"red"},ot={key:3,style:{"background-color":"#F5E2C6",border:"1px solid #F59A23",color:"#F59A23"},class:"red"},nt={key:4,style:{"background-color":"#F0E0FC",border:"1px solid #8400FF",color:"#8400FF"},class:"red"},at={key:0},rt=b(()=>c("br",null,null,-1)),st={key:1},it=b(()=>c("br",null,null,-1)),ut={key:0},dt=b(()=>c("br",null,null,-1)),pt={key:1},ct=b(()=>c("br",null,null,-1)),_t={key:0},mt=b(()=>c("br",null,null,-1)),ft={key:1},gt=b(()=>c("br",null,null,-1)),yt={key:0},ht=b(()=>c("br",null,null,-1)),wt={key:1},bt=b(()=>c("br",null,null,-1)),kt={key:0,class:"red"},vt={key:1,style:{"background-color":"#D2FAFA",border:"1px solid #00AAAA",color:"#00AAAA"},class:"green"},It={key:2,class:"green"},St={key:3,style:{"background-color":"#F2F2F2",border:"1px solid #7F7F7F",color:"#7F7F7F"},class:"green"},xt={key:4,class:"red"},Ct={class:"ub ub-h ub-ac"},Vt={class:"green"},Ft={style:{"margin-left":"10px"}},Dt={class:"dialog-footer"},Tt=xe({name:"User"}),Pt=Object.assign(Tt,{setup(h){var G,X;const{tableRef:ae,handleHeaderDragend:re,applyStoredColumnWidths:se}=$e("moneyLog-table"),{copyText:U}=Ne(),ie=Ce(),{proxy:k}=Ve(),M=g([]);g(!1),g(!1);const D=g(!1),q=g(!0),ue=g(!0),$=g([]);g(!0),g(!0);const B=g(0);g("");const N=g([]);z([{label:"实盘",value:0},{label:"模拟",value:1}]),z([{label:"顶级代理",value:0}]);const de=z({form:{isBlockTrading:!0,stockPlate:" ",isShow:!0,isLock:!1},form1:{},queryParams:{pageNo:1,pageSize:10,tradingOrderSn:((X=(G=ie.currentRoute.value)==null?void 0:G.query)==null?void 0:X.tradingOrderSn)||void 0},rules1:{lockInPeriod:[{required:!0,message:"请输入锁仓天数",trigger:"blur"}]},rules:{awardQuantity:[{required:!0,message:"中签数量不能为空",trigger:"blur"}]},userRef:{num:[{required:!0,message:"转入股数不能为空",trigger:"blur"}]},payData:{num:0}});function Q(d){if($.value.length==0){k.$modal.msgError("请选择订单");return}d==1?J($.value):fe($.value)}const{queryParams:u,form:W,rules:$t,form1:Nt,rules1:At,payData:y}=Fe(de);function pe(d){console.log(d),$.value=[];for(let o=0;o<d.length;o++)$.value.push({id:d[o].id,shares:d[o].buyingShares})}function v(){q.value=!0;let d=Object.assign({},u.value);d.stockPlate=d.stockPlate==-1?"":d.stockPlate,Re(ce(d,N.value)).then(o=>{q.value=!1,M.value=o.data.records,B.value=o.data.total,se()})}function ce(d,o,P){let p=d;return p.params=typeof p.params=="object"&&p.params!==null&&!Array.isArray(p.params)?p.params:{},o=Array.isArray(o)?o:[],p.pendingTimeStart=o[0]&&o[0]+" 00:00:00",p.pendingTimeEnd=o[1]&&o[1]+" 23:59:59",p}function S(){u.value.pageNo=1,v()}function _e(){N.value=[],k.resetForm("queryRef"),S()}function J(d){if(d.length==0){k.$modal.msgError("请选择订单");return}k.$modal.confirm("是否确定要拒绝该订单？此操作不可恢复").then(function(){return Ee(d)}).then(()=>{v(),k.$modal.msgSuccess("操作成功")}).catch(()=>{})}function me(d){Ue({id:d.id}).then(o=>{D.value=!0,y.value=o.data,y.value.num=o.data.buyingShares})}function fe(d){if(d.length==0){k.$modal.msgError("请选择订单");return}k.$modal.confirm("是否确定要转入该订单？此操作不可恢复").then(function(){return ne(d)}).then(()=>{v(),k.$modal.msgSuccess("操作成功")}).catch(()=>{})}function ge(){k.$refs.userRef.validate(d=>{d&&ne([{shares:y.value.num,id:y.value.id}]).then(o=>{k.$modal.msgSuccess("转入成功"),D.value=!1,v()})})}const x=g(null);let T=null;const C=g(0);function ye(){T&&(clearInterval(T),T=null),x.value?(C.value=x.value/1e3,T=setInterval(()=>{C.value>0&&C.value--,C.value===0&&(v(),C.value=x.value/1e3)},1e3),v()):C.value=0}return De(()=>{T&&clearInterval(T)}),v(),(d,o)=>{const P=f("el-input"),p=f("el-form-item"),w=f("el-option"),Z=f("el-select"),he=f("el-date-picker"),I=f("el-button"),ee=f("el-form"),A=f("el-col"),L=f("el-row"),m=f("el-table-column"),E=f("CopyDocument"),K=f("el-icon"),te=f("el-tooltip"),we=f("el-table"),be=f("pagination"),ke=f("el-input-number"),ve=f("el-dialog"),H=le("hasPermi"),Ie=le("loading");return a(),i("div",Ke,[t(L,{gutter:20},{default:l(()=>[t(A,{xs:24},{default:l(()=>[V(t(ee,{model:n(u),ref:"queryRef",inline:!0,"label-width":"100"},{default:l(()=>[t(p,{label:"委托ID",prop:"id"},{default:l(()=>[t(P,{modelValue:n(u).id,"onUpdate:modelValue":o[0]||(o[0]=e=>n(u).id=e),modelModifiers:{number:!0},type:"number",placeholder:"请输入委托ID",clearable:"",style:{width:"120px"},onKeyup:R(S,["enter"])},null,8,["modelValue"])]),_:1}),t(p,{label:"持仓ID",prop:"positionId","label-width":"100"},{default:l(()=>[t(P,{type:"number",modelValue:n(u).positionId,"onUpdate:modelValue":o[1]||(o[1]=e=>n(u).positionId=e),placeholder:"请输入持仓ID",clearable:"",style:{width:"120px"},onKeyup:R(S,["enter"])},null,8,["modelValue"])]),_:1}),t(p,{label:"交易订单号",prop:"tradingOrderSn"},{default:l(()=>[t(P,{modelValue:n(u).tradingOrderSn,"onUpdate:modelValue":o[2]||(o[2]=e=>n(u).tradingOrderSn=e),placeholder:"请输入交易订单号",clearable:"",style:{width:"200px"},onKeyup:R(S,["enter"])},null,8,["modelValue"])]),_:1}),t(p,{label:"股票查询",prop:"stockCodeOrName"},{default:l(()=>[t(P,{modelValue:n(u).stockCodeOrName,"onUpdate:modelValue":o[3]||(o[3]=e=>n(u).stockCodeOrName=e),placeholder:"请输入股票名称或股票代码",clearable:"",style:{width:"120px"},onKeyup:R(S,["enter"])},null,8,["modelValue"])]),_:1}),t(p,{label:"股票类型",prop:"stockType"},{default:l(()=>[t(n(Oe),{style:{width:"120px"},value:n(u).stockType,"onUpdate:value":o[4]||(o[4]=e=>n(u).stockType=e),values:n(W).stockType||0,placeholder:"全部"},null,8,["value","values"])]),_:1}),t(p,{label:"会员查询",prop:"userId"},{default:l(()=>[t(P,{oninput:"if(value.length>6)value=value.slice(0,6)",type:"number",modelValue:n(u).userId,"onUpdate:modelValue":o[5]||(o[5]=e=>n(u).userId=e),placeholder:"请输入会员ID",clearable:"",style:{width:"120px"},onKeyup:R(S,["enter"])},null,8,["modelValue"])]),_:1}),t(p,{label:"所属代理",prop:"agentId"},{default:l(()=>[t(n(Ae),{style:{width:"150px"},value:n(u).agentId,"onUpdate:value":o[6]||(o[6]=e=>n(u).agentId=e),values:n(u).agentId,placeholder:"全部"},null,8,["value","values"])]),_:1}),t(p,{label:"订单状态",prop:"positionStatus"},{default:l(()=>[t(Z,{modelValue:n(u).positionStatus,"onUpdate:modelValue":o[7]||(o[7]=e=>n(u).positionStatus=e),style:{width:"120px"},placeholder:"全部"},{default:l(()=>[t(w,{key:"-1",label:"全部",value:""}),t(w,{key:"0",label:"已委托",value:1},{default:l(()=>[r("已委托")]),_:1}),t(w,{key:"1",label:"已成交",value:2},{default:l(()=>[r("已成交")]),_:1}),t(w,{key:"2",label:"已撤销",value:3},{default:l(()=>[r("已撤销")]),_:1}),t(w,{key:"3",label:"已拒绝",value:4},{default:l(()=>[r("已拒绝")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(p,{label:"委托时间",style:{width:"308px"}},{default:l(()=>[t(he,{modelValue:n(N),"onUpdate:modelValue":o[8]||(o[8]=e=>Y(N)?N.value=e:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),t(p,null,{default:l(()=>[t(I,{type:"primary",icon:"Search",onClick:S},{default:l(()=>[r("搜索")]),_:1}),t(I,{icon:"Refresh",onClick:_e},{default:l(()=>[r("重置")]),_:1})]),_:1}),t(p,{label:"自动刷新"},{default:l(()=>[t(Z,{modelValue:n(x),"onUpdate:modelValue":o[9]||(o[9]=e=>Y(x)?x.value=e:null),onChange:ye,style:{width:"120px"},placeholder:"关闭"},{default:l(()=>[t(w,{label:"关闭",value:null}),t(w,{label:"5秒",value:5e3}),t(w,{label:"10秒",value:1e4}),t(w,{label:"30秒",value:3e4}),t(w,{label:"1分钟",value:6e4}),t(w,{label:"3分钟",value:18e4}),t(w,{label:"5分钟",value:3e5})]),_:1},8,["modelValue"]),n(x)?(a(),i("span",He,s(n(C))+" 秒后自动刷新",1)):_("",!0)]),_:1})]),_:1},8,["model"]),[[oe,n(ue)]]),t(L,{gutter:10,class:"mb8"},{default:l(()=>[t(A,{span:1.5},{default:l(()=>[V((a(),F(I,{type:"danger",onClick:o[10]||(o[10]=e=>Q(1))},{default:l(()=>[r("批量拒绝")]),_:1})),[[H,["pendingReject"]]]),V((a(),F(I,{type:"primary",onClick:o[11]||(o[11]=e=>Q(2))},{default:l(()=>[r("批量转入")]),_:1})),[[H,["pendingTransferPosition"]]])]),_:1})]),_:1}),V((a(),F(we,{border:"",data:n(M),onSelectionChange:pe,onHeaderDragend:n(re),ref_key:"tableRef",ref:ae},{default:l(()=>[t(m,{type:"selection",width:"50",align:"center"}),t(m,{label:"委托ID",align:"center",width:"100",key:"id",prop:"id","show-overflow-tooltip":!0},{default:l(e=>[c("span",null,s(e.row.id),1),t(K,{style:{cursor:"pointer","margin-left":"4px"},onClick:O=>n(U)(e.row.id)},{default:l(()=>[t(E)]),_:2},1032,["onClick"])]),_:1}),t(m,{label:"用户信息",align:"center",width:"150","show-overflow-tooltip":!0},{default:l(e=>[e.row.userId?(a(),i("span",je,[r(s(e.row.realName?e.row.realName:e.row.nickname),1),qe,r(" "+s(e.row.userId),1),t(K,{style:{cursor:"pointer","margin-left":"4px"},onClick:O=>n(U)(e.row.userId)},{default:l(()=>[t(E)]),_:2},1032,["onClick"]),Be,r(" L"+s(e.row.levelId)+"-"+s(e.row.levelName),1)])):(a(),i("span",Le,"-"))]),_:1}),t(m,{label:"直属代理",align:"center",key:"agentName",prop:"agentName",width:"150","show-overflow-tooltip":!0},{default:l(e=>[e.row.agentId?(a(),i("span",ze,[r(s(e.row.agentName),1),Ye,r("（"+s(e.row.agentId)+"）",1)])):(a(),i("span",Me,"-"))]),_:1}),t(m,{label:"团队总代(ID)",align:"center",width:"150"},{default:l(e=>[e.row.generalAgentId?(a(),i("span",Qe,[r(s(e.row.generalAgentName),1),We,r("（"+s(e.row.generalAgentId)+"）",1)])):(a(),i("span",Je,"-"))]),_:1}),t(m,{label:"持仓ID",align:"center",width:"100",key:"positionId",prop:"positionId","show-overflow-tooltip":!0},{default:l(e=>[e.row.positionId?(a(),i("span",Ge,[r(s(e.row.positionId)+" ",1),t(K,{style:{cursor:"pointer","margin-left":"4px"},onClick:O=>n(U)(e.row.positionId)},{default:l(()=>[t(E)]),_:2},1032,["onClick"])])):(a(),i("span",Xe,"-"))]),_:1}),t(m,{label:"交易订单号",width:"190",align:"center","show-overflow-tooltip":!0},{default:l(e=>[r(s(e.row.tradingOrderSn),1),t(K,{style:{cursor:"pointer","margin-left":"4px"},onClick:O=>n(U)(e.row.tradingOrderSn)},{default:l(()=>[t(E)]),_:2},1032,["onClick"])]),_:1}),t(m,{label:"股票名称/股票代码",width:"180",align:"center",key:"parentId",prop:"parentId","show-overflow-tooltip":!0},{default:l(e=>[c("span",null,[r(s(e.row.stockName)+"  ",1),c("span",Ze,s(e.row.stockCode),1)])]),_:1}),t(m,{label:"股票类型",width:"80",align:"center",key:"agentName",prop:"agentName","show-overflow-tooltip":!0},{default:l(e=>[e.row.stockType=="sh"?(a(),i("span",et,"泸股")):_("",!0),e.row.stockType=="sz"?(a(),i("span",tt,"深股")):_("",!0),e.row.stockType=="bj"?(a(),i("span",lt,"北证")):_("",!0),e.row.stockType=="hk"?(a(),i("span",ot,"港股")):_("",!0),e.row.stockType=="us"?(a(),i("span",nt,"美股")):_("",!0)]),_:1}),t(m,{label:"购买股数",width:"120",align:"center",key:"buyingShares",prop:"buyingShares","show-overflow-tooltip":!0}),t(m,{label:"杠杆倍数",width:"80",align:"center",key:"lever",prop:"lever","show-overflow-tooltip":!0}),t(m,{label:"当前价格",width:"130",align:"center",key:"nowPrice",prop:"nowPrice","show-overflow-tooltip":!0},{default:l(e=>[c("span",null,[e.row.stockType=="hk"?(a(),i("span",at,[r("HK$"+s(e.row.nowPrice),1),rt])):_("",!0),e.row.stockType=="us"?(a(),i("span",st,[r("$"+s(e.row.nowPrice),1),it])):_("",!0),r(" ￥"+s((e.row.nowPrice/e.row.exchangeRate).toFixed(3)),1)])]),_:1}),t(m,{label:"买入价格",width:"130",align:"center",key:"buyingPrice",prop:"buyingPrice","show-overflow-tooltip":!0},{default:l(e=>[c("span",null,[e.row.stockType=="hk"?(a(),i("span",ut,[r("HK$"+s(e.row.buyingPrice),1),dt])):_("",!0),e.row.stockType=="us"?(a(),i("span",pt,[r("$"+s(e.row.buyingPrice),1),ct])):_("",!0),r(" ￥"+s((e.row.buyingPrice/e.row.exchangeRate).toFixed(3)),1)])]),_:1}),t(m,{label:"手续费",width:"130",align:"center",key:"buyingFee",prop:"buyingFee","show-overflow-tooltip":!0},{default:l(e=>[c("span",null,[e.row.stockType=="hk"?(a(),i("span",_t,[r("HK$"+s(e.row.buyingFee),1),mt])):_("",!0),e.row.stockType=="us"?(a(),i("span",ft,[r("$"+s(e.row.buyingFee),1),gt])):_("",!0),r(" ￥"+s((e.row.buyingFee/e.row.exchangeRate).toFixed(2)),1)])]),_:1}),t(m,{label:"印花税",width:"130",align:"center",key:"nowPrice",prop:"nowPrice","show-overflow-tooltip":!0},{default:l(e=>[c("span",null,[e.row.stockType=="hk"?(a(),i("span",yt,[r("HK$"+s(e.row.buyingStampDuty),1),ht])):_("",!0),e.row.stockType=="us"?(a(),i("span",wt,[r("$"+s(e.row.buyingStampDuty),1),bt])):_("",!0),r(" ￥"+s((e.row.buyingStampDuty/e.row.exchangeRate).toFixed(2)),1)])]),_:1}),t(m,{label:"订单状态",width:"80",align:"center",key:"positionDirection",prop:"positionDirection"},{default:l(e=>[e.row.positionStatus==0?(a(),i("span",kt,"待提交")):_("",!0),e.row.positionStatus==1?(a(),i("span",vt,"已委托")):_("",!0),e.row.positionStatus==2?(a(),i("span",It,"已成交")):_("",!0),e.row.positionStatus==3?(a(),i("span",St,"已撤销")):_("",!0),e.row.positionStatus==4?(a(),i("span",xt,"已拒绝")):_("",!0)]),_:1}),t(m,{label:"委托时间",width:"160",align:"center",key:"pendingTime",prop:"pendingTime"}),t(m,{label:"成交时间",width:"160",align:"center",key:"positionTime",prop:"positionTime"}),t(m,{label:"操作",fixed:"right",align:"center",width:"250","class-name":"small-padding fixed-width"},{default:l(e=>[e.row.positionStatus==1?(a(),F(te,{key:0,disabled:"true",content:"拒绝",placement:"none"},{default:l(()=>[V((a(),F(I,{type:"danger",onClick:O=>J([e.row.id])},{default:l(()=>[r("拒绝")]),_:2},1032,["onClick"])),[[H,["pendingReject"]]])]),_:2},1024)):_("",!0),e.row.positionStatus==1?(a(),F(te,{key:1,disabled:"true",content:"转入",placement:"none"},{default:l(()=>[V((a(),F(I,{type:"primary",onClick:O=>me(e.row)},{default:l(()=>[r("转入")]),_:2},1032,["onClick"])),[[H,["pendingTransferPosition"]]])]),_:2},1024)):_("",!0)]),_:1})]),_:1},8,["data","onHeaderDragend"])),[[Ie,n(q)]]),V(t(be,{total:n(B),page:n(u).pageNo,"onUpdate:page":o[12]||(o[12]=e=>n(u).pageNo=e),onPagination:v,limit:n(u).pageSize,"onUpdate:limit":o[13]||(o[13]=e=>n(u).pageSize=e)},null,8,["total","page","limit"]),[[oe,n(B)>0]])]),_:1})]),_:1}),t(ve,{title:"转入",modelValue:n(D),"onUpdate:modelValue":o[16]||(o[16]=e=>Y(D)?D.value=e:null),width:"600px","append-to-body":""},{footer:l(()=>[c("div",Dt,[t(I,{type:"primary",onClick:ge},{default:l(()=>[r("确 定")]),_:1}),t(I,{onClick:o[15]||(o[15]=e=>D.value=!1)},{default:l(()=>[r("取 消")]),_:1})])]),default:l(()=>[t(ee,{model:n(W),ref:"userRef","label-width":"80px"},{default:l(()=>[t(L,null,{default:l(()=>[t(A,{span:24},{default:l(()=>[t(p,{"label-width":"auto",label:n(y).stockName,prop:"tradeEnable"},{default:l(()=>[c("div",Ct,[c("span",Vt,s(n(y).stockCode),1),c("span",Ft,"每手"+s(n(y).sharesOfHand)+"股",1)])]),_:1},8,["label"])]),_:1}),t(A,{span:24},{default:l(()=>[t(p,{"label-width":"100",label:"委托股数",prop:"tradeEnable"},{default:l(()=>[r(s(n(y).buyingShares),1)]),_:1})]),_:1}),t(A,{span:24},{default:l(()=>[t(p,{"label-width":"100",label:"转持仓股数",prop:"tradeEnable"},{default:l(()=>[t(ke,{min:n(y).sharesOfHand,max:n(y).buyingShares,modelValue:n(y).num,"onUpdate:modelValue":o[14]||(o[14]=e=>n(y).num=e),step:n(y).sharesOfHand},null,8,["min","max","modelValue","step"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),jt=Se(Pt,[["__scopeId","data-v-6fe3a072"]]);export{jt as default};
